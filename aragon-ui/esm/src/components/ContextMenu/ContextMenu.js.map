{"version":3,"file":"ContextMenu.js","sources":["../../../../../src/components/ContextMenu/ContextMenu.js"],"sourcesContent":["import React, { useState, useCallback } from 'react'\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\nimport { Spring, animated } from 'react-spring'\nimport ClickOutHandler from 'react-onclickout'\nimport { useTheme } from '../../theme'\nimport { springs, RADIUS } from '../../style'\nimport { IconEllipsis, IconDown } from '../../icons/components'\nimport ButtonBase from '../ButtonBase/ButtonBase'\n\nconst BASE_WIDTH = 46\nconst BASE_HEIGHT = 32\n\nfunction ContextMenu({ children, zIndex, disabled }) {\n  const theme = useTheme()\n  const [opened, setOpened] = useState(false)\n\n  const handleClose = useCallback(() => {\n    setOpened(false)\n  }, [])\n\n  const handleBaseButtonClick = useCallback(() => {\n    setOpened(opened => !opened)\n  }, [])\n\n  // Increase the z-index on an opened menu, to make sure it's above any other\n  // context menus below it using the same z-index (e.g. when used in a list)\n  const appliedZIndex = opened ? zIndex + 1 : zIndex\n\n  return (\n    <ClickOutHandler onClickOut={handleClose}>\n      <Spring\n        config={springs.smooth}\n        to={{ openProgress: Number(opened) }}\n        native\n      >\n        {({ openProgress }) => (\n          <Main\n            css={`\n              z-index: ${appliedZIndex};\n            `}\n            style={{\n              boxShadow: openProgress.interpolate(\n                t => `0 4px 4px rgba(0, 0, 0, ${t * 0.03})`\n              ),\n            }}\n          >\n            <Button\n              onClick={handleBaseButtonClick}\n              opened={opened}\n              disabled={disabled}\n              focusRingRadius={RADIUS}\n              css={`\n                color: ${disabled\n                  ? theme.disabledContent\n                  : opened\n                  ? theme.accent\n                  : theme.surfaceContent};\n                background: ${disabled ? theme.disabled : theme.surface};\n                border: ${disabled ? '0' : `1px solid ${theme.border}`};\n                border-bottom-color: ${opened ? theme.surface : theme.border};\n                ${disabled\n                  ? ''\n                  : `&:active {\n                  background: ${theme.surfacePressed};\n                  border-bottom-color: ${\n                    opened ? theme.surfacePressed : theme.border\n                  };\n                }`}\n              `}\n            >\n              <IconEllipsis css={``} />\n              <animated.div\n                style={{\n                  display: 'flex',\n                  alignItems: 'center',\n                  transformOrigin: '50% 50%',\n                  transform: openProgress.interpolate(\n                    v => `rotate(${v * 180}deg)`\n                  ),\n                }}\n              >\n                <IconDown\n                  size=\"tiny\"\n                  css={`\n                    color: ${disabled ? theme.disabledIcon : theme.surfaceIcon};\n                  `}\n                />\n              </animated.div>\n            </Button>\n            {opened && (\n              <React.Fragment>\n                <animated.div\n                  onClick={handleClose}\n                  style={{\n                    opacity: openProgress,\n                    boxShadow: openProgress.interpolate(\n                      t => `0 4px 4px rgba(0, 0, 0, ${t * 0.03})`\n                    ),\n                  }}\n                  css={`\n                    z-index: ${appliedZIndex + 1};\n                    overflow: hidden;\n                    position: absolute;\n                    top: ${BASE_HEIGHT - 1}px;\n                    right: 0;\n                    background: ${theme.surface};\n                    border: 1px solid ${theme.border};\n                    border-radius: 3px 0 3px 3px;\n                  `}\n                >\n                  {children}\n                </animated.div>\n                <div\n                  css={`\n                    z-index: ${appliedZIndex + 1};\n                    position: absolute;\n                    bottom: 0;\n                    right: 1px;\n                    height: 1px;\n                    width: ${BASE_WIDTH - 2}px;\n                    background: ${theme.surface};\n                  `}\n                />\n              </React.Fragment>\n            )}\n          </Main>\n        )}\n      </Spring>\n    </ClickOutHandler>\n  )\n}\n\nContextMenu.propTypes = {\n  children: PropTypes.node,\n  zIndex: PropTypes.number,\n  disabled: PropTypes.bool,\n}\nContextMenu.defaultProps = {\n  zIndex: 0,\n  disabled: false,\n}\n\nconst Main = styled(animated.div)`\n  position: relative;\n  width: ${BASE_WIDTH}px;\n  height: ${BASE_HEIGHT}px;\n`\n\nconst Button = styled(ButtonBase)`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 100%;\n  height: ${BASE_HEIGHT}px;\n  border-radius: ${({ opened }) =>\n    opened ? `${RADIUS}px ${RADIUS}px 0 0` : `${RADIUS}px`};\n\n  box-shadow: ${({ disabled }) =>\n    disabled ? 'none' : `0px 1px 3px rgba(0, 0, 0, 0.1)`};\n`\n\nexport default ContextMenu\n"],"names":["BASE_WIDTH","BASE_HEIGHT","ContextMenu","children","zIndex","disabled","theme","useTheme","useState","opened","setOpened","handleClose","useCallback","handleBaseButtonClick","appliedZIndex","React","ClickOutHandler","springs","smooth","openProgress","Number","boxShadow","interpolate","t","RADIUS","disabledContent","accent","surfaceContent","surface","border","surfacePressed","animated","display","alignItems","transformOrigin","transform","v","disabledIcon","surfaceIcon","opacity","propTypes","PropTypes","node","number","bool","defaultProps","Main","styled","div","Button","ButtonBase"],"mappings":"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"}